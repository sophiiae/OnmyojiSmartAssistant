# OSA项目exe构建说明

## 概述

本项目生成一个完整的exe程序：
**OSA.exe** - 图形界面程序，包含配置编辑和脚本运行功能

### 主要特性

✅ **统一程序** - 一个exe文件包含所有功能  
✅ **配置编辑** - 图形界面编辑所有配置  
✅ **脚本运行** - 点击运行按钮自动执行脚本  
✅ **日志显示** - 内置日志窗口显示运行状态  
✅ **多配置支持** - 支持多个配置文件切换

## 构建方法

### 方法一：使用批处理文件（推荐）

1. 双击运行 `build.bat`
2. 等待构建完成

### 方法二：手动构建

1. 安装PyInstaller：
   ```bash
   pip install pyinstaller
   ```

2. 运行构建脚本：
   ```bash
   python build_exe.py
   ```

## 输出文件

构建完成后，exe文件将保存在项目根目录下：

- `OSA.exe` - 完整的配置编辑和脚本运行程序

## 使用说明

### OSA程序

1. 双击运行 `OSA.exe`
2. 在图形界面中编辑配置
3. 点击"运行"按钮执行脚本
4. 程序会自动根据当前选中的配置文件运行相应的脚本

## 注意事项

1. **文件大小**：由于包含了所有依赖库，exe文件可能比较大（100-200MB）
2. **首次启动**：exe文件首次启动可能较慢，这是正常现象
3. **杀毒软件**：某些杀毒软件可能会误报，需要添加信任
4. **权限**：某些功能可能需要管理员权限

## 故障排除

### 构建失败

1. 运行测试脚本检查环境：
   ```bash
   python test_exe.py
   ```
2. 确保Python环境正确安装
3. 确保所有依赖包已安装：
   ```bash
   pip install -r requirements.txt
   ```
4. 确保有足够的磁盘空间（至少1GB）

### 运行失败

1. **配置文件错误**：确保exe文件与configs目录在同一目录
2. **路径问题**：exe会自动在exe所在目录查找配置文件
3. **权限问题**：尝试以管理员身份运行
4. **杀毒软件**：某些杀毒软件可能会误报，需要添加信任

### 常见错误

#### 1. "No such file or directory: 'fairy.json'"
- **原因**：PyInstaller包含了错误的文件
- **解决**：重新构建exe，已修复此问题

#### 2. "configs目录不存在"
- **原因**：配置文件目录路径错误
- **解决**：确保exe文件与configs目录在同一目录

#### 3. "无法加载配置文件"
- **原因**：配置文件格式错误或损坏
- **解决**：检查配置文件是否为有效的JSON格式

### 缺少文件

如果运行时提示缺少文件，请确保以下目录和文件存在：
- `configs/` - 配置文件目录（包含.json文件，默认使用osa.json）
- `tasks/` - 任务脚本目录
- `module/` - 核心模块目录
- `data/` - 数据文件目录
- `logs/` - 日志目录

### 测试构建

在构建exe之前，建议先运行测试脚本：
```bash
python test_exe.py
```

这会检查所有必要的文件和依赖是否正确安装。

## 自定义构建

如果需要修改构建配置，可以编辑 `build_exe.py` 文件中的spec内容：

- 修改 `datas` 列表来包含更多文件
- 修改 `hiddenimports` 列表来包含更多模块
- 修改 `name` 来改变exe文件名
- 修改 `console` 来改变是否显示控制台窗口 